/*
 tableExport.jquery.plugin

 Copyright (c) 2015,2016 hhurz, https://github.com/hhurz/tableExport.jquery.plugin
 Original work Copyright (c) 2014 Giri Raj, https://github.com/kayalshri/

 Licensed under the MIT License, http://opensource.org/licenses/mit-license
*/
!function(t){t.fn.extend({tableExport:function(e){function n(e){var n=[];return t(e).find("thead").first().find("th").each(function(e,o){void 0!==t(o).attr("data-field")?n[e]=t(o).attr("data-field"):n[e]=e.toString()}),n}function o(e,n){var o=!1;return D.ignoreColumn.length>0&&("string"==typeof D.ignoreColumn[0]?H.length>n&&"undefined"!=typeof H[n]&&-1!=t.inArray(H[n],D.ignoreColumn)&&(o=!0):"number"==typeof D.ignoreColumn[0]&&(-1!=t.inArray(n,D.ignoreColumn)||-1!=t.inArray(n-e.length,D.ignoreColumn))&&(o=!0)),o}function i(e,n,i,a,r){if(-1==t.inArray(i,D.ignoreRow)&&-1==t.inArray(i-a,D.ignoreRow)){var l=t(e).filter(function(){return"none"!=t(this).data("tableexportDisplay")&&(t(this).is(":visible")||"always"==t(this).data("tableexportDisplay")||"always"==t(this).closest("table").data("tableexportDisplay"))}).find(n),s=0,f=0;if(l.each(function(e){if(("always"==t(this).data("tableexportDisplay")||"none"!=t(this).css("display")&&"hidden"!=t(this).css("visibility")&&"none"!=t(this).data("tableexportDisplay"))&&o(l,e)===!1&&"function"==typeof r){var n,a,d=0,h=0;if("undefined"!=typeof I[i]&&I[i].length>0)for(n=0;e>=n;n++)"undefined"!=typeof I[i][n]&&(r(null,i,n),delete I[i][n],e++);for(f=e,t(this).is("[colspan]")&&(d=parseInt(t(this).attr("colspan")),s+=d>0?d-1:0),t(this).is("[rowspan]")&&(h=parseInt(t(this).attr("rowspan"))),r(this,i,e),n=0;d-1>n;n++)r(null,i,e+n);if(h)for(a=1;h>a;a++)for("undefined"==typeof I[i+a]&&(I[i+a]=[]),I[i+a][e+s]="",n=1;d>n;n++)I[i+a][e+s-n]=""}}),"undefined"!=typeof I[i]&&I[i].length>0)for(var d=0;d<=I[i].length;d++)"undefined"!=typeof I[i][d]&&(r(null,i,d),delete I[i][d])}}function a(t){if(D.consoleLog===!0&&console.log(t.output()),"string"===D.outputMode)return t.output();if("base64"===D.outputMode)return j(t.output());if("window"===D.outputMode)return void window.open(URL.createObjectURL(t.output("blob")));try{var e=t.output("blob");saveAs(e,D.fileName+".pdf")}catch(n){E(D.fileName+".pdf","data:application/pdf;base64,",t.output())}}function r(t,e,n){var o=0;if("undefined"!=typeof n&&(o=n.colspan),o>=0){for(var i=t.width,a=t.textPos.x,r=e.table.columns.indexOf(e.column),l=1;o>l;l++){var s=e.table.columns[r+l];i+=s.width}if(o>1&&("right"===t.styles.halign?a=t.textPos.x+i-t.width:"center"===t.styles.halign&&(a=t.textPos.x+(i-t.width)/2)),t.width=i,t.textPos.x=a,"undefined"!=typeof n&&n.rowspan>1&&(t.height=t.height*n.rowspan),"middle"===t.styles.valign||"bottom"===t.styles.valign){var f="string"==typeof t.text?t.text.split(/\r\n|\r|\n/g):t.text,d=f.length||1;d>2&&(t.textPos.y-=(2-O)/2*e.row.styles.fontSize*(d-2)/3)}return!0}return!1}function l(e,n,o){"undefined"!=typeof o.images&&n.each(function(){var n=t(this).children();if(t(this).is("img")){var i=N(this.src);o.images[i]={url:this.src,src:this.src}}"undefined"!=typeof n&&n.length>0&&l(e,n,o)})}function s(t,e){function n(){e(a)}function o(t){if(t.url){var e=new Image;a=++r,e.crossOrigin="Anonymous",e.onerror=e.onload=function(){if(e.complete&&(0===e.src.indexOf("data:image/")&&(e.width=t.width||e.width||0,e.height=t.height||e.height||0),e.width+e.height)){var o=document.createElement("canvas"),i=o.getContext("2d");o.width=e.width,o.height=e.height,i.drawImage(e,0,0),t.src=o.toDataURL("image/jpeg")}--r||n()},e.src=t.url}}var i,a=0,r=0;if("undefined"!=typeof t.images)for(i in t.images)t.images.hasOwnProperty(i)&&o(t.images[i]);return r||n()}function f(e,n,o){n.each(function(){var n=t(this).children();if(t(this).is("div")){var i=g(v(this,"background-color"),[255,255,255]),a=g(v(this,"border-top-color"),[0,0,0]),r=w(this,"border-top-width",D.jspdf.unit),l=this.getBoundingClientRect(),s=this.offsetLeft*o.dw,d=this.offsetTop*o.dh,h=l.width*o.dw,c=l.height*o.dh;o.doc.setDrawColor.apply(void 0,a),o.doc.setFillColor.apply(void 0,i),o.doc.setLineWidth(r),o.doc.rect(e.x+s,e.y+d,h,c,r?"FD":"F")}else if(t(this).is("img")&&"undefined"!=typeof o.images){var u=N(this.src),p=o.images[u];if("undefined"!=typeof p){var y=e.width/e.height,m=this.width/this.height,b=e.width,x=e.height,d=0;y>m?(x=Math.min(e.height,this.height),b=this.width*x/this.height):m>y&&(b=Math.min(e.width,this.width),x=this.height*b/this.width),x<e.height&&(d=(e.height-x)/2),o.doc.addImage(p.src,e.textPos.x,e.y+d,b,x),e.textPos.x+=b}}"undefined"!=typeof n&&n.length>0&&f(e,n,o)})}function d(t){return t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function h(t,e,n){return t.replace(new RegExp(d(e),"g"),n)}function c(t,e,n){var o="";if(null!==t){var i=p(t,e,n),a=null===i||""===i?"":i.toString();i instanceof Date?o=D.csvEnclosure+i.toLocaleString()+D.csvEnclosure:(o=h(a,D.csvEnclosure,D.csvEnclosure+D.csvEnclosure),(o.indexOf(D.csvSeparator)>=0||/[\r\n ]/g.test(o))&&(o=D.csvEnclosure+o+D.csvEnclosure))}return o}function u(t){return t=t||"0",t=h(t,D.numbers.html.decimalMark,"."),t=h(t,D.numbers.html.thousandsSeparator,""),"number"==typeof t||jQuery.isNumeric(t)!==!1?t:!1}function p(e,n,o){var i="";if(null!==e){var a,r=t(e);if(a=r[0].hasAttribute("data-tableexport-value")?r.data("tableexportValue"):r.html(),""!=a){var l=t.parseHTML(a);a="",t.each(l,function(){if(t(this).is("input"))a+=r.find("input").val();else{if(!t(this).is("select"))return a+=r.html(),!1;a+=r.find("select option:selected").text()}})}if("function"==typeof D.onCellHtmlData&&(a=D.onCellHtmlData(r,n,o,a)),D.htmlContent===!0)i=t.trim(a);else{var s=a.replace(/\n/g,"\u2028").replace(/<br\s*[\/]?>/gi,"⁠"),f=t("<div/>").html(s).contents();if(s="",t.each(f.text().split("\u2028"),function(e,n){e>0&&(s+=" "),s+=t.trim(n)}),t.each(s.split("⁠"),function(e,n){e>0&&(i+="\n"),i+=t.trim(n).replace(/\u00AD/g,"")}),D.numbers.html.decimalMark!=D.numbers.output.decimalMark||D.numbers.html.thousandsSeparator!=D.numbers.output.thousandsSeparator){var d=u(i);if(d!==!1){var h=(""+d).split(".");1==h.length&&(h[1]="");var c=h[0].length>3?h[0].length%3:0;i=(0>d?"-":"")+(D.numbers.output.thousandsSeparator?(c?h[0].substr(0,c)+D.numbers.output.thousandsSeparator:"")+h[0].substr(c).replace(/(\d{3})(?=\d)/g,"$1"+D.numbers.output.thousandsSeparator):h[0])+(h[1].length?D.numbers.output.decimalMark+h[1]:"")}}}D.escape===!0&&(i=escape(i)),"function"==typeof D.onCellData&&(i=D.onCellData(r,n,o,i))}return i}function y(t,e,n){return e+"-"+n.toLowerCase()}function g(t,e){var n=/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,o=n.exec(t),i=e;return o&&(i=[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]),i}function m(e){var n=v(e,"text-align"),o=v(e,"font-weight"),i=v(e,"font-style"),a="";"start"==n&&(n="rtl"==v(e,"direction")?"right":"left"),o>=700&&(a="bold"),"italic"==i&&(a+=i),""===a&&(a="normal");var r={style:{align:n,bcolor:g(v(e,"background-color"),[255,255,255]),color:g(v(e,"color"),[0,0,0]),fstyle:a},colspan:parseInt(t(e).attr("colspan"))||0,rowspan:parseInt(t(e).attr("rowspan"))||0};if(null!==e){var l=e.getBoundingClientRect();r.rect={width:l.width,height:l.height}}return r}function v(t,e){try{return window.getComputedStyle?(e=e.replace(/([a-z])([A-Z])/,y),window.getComputedStyle(t,null).getPropertyValue(e)):t.currentStyle?t.currentStyle[e]:t.style[e]}catch(n){}return""}function b(t,e,n){var o=100,i=document.createElement("div");i.style.overflow="hidden",i.style.visibility="hidden",t.appendChild(i),i.style.width=o+n;var a=o/i.offsetWidth;return t.removeChild(i),e*a}function w(t,e,n){var o=v(t,e),i=o.match(/\d+/);return null!==i?(i=i[0],b(t.parentElement,i,n)):0}function x(){return this instanceof x?(this.SheetNames=[],void(this.Sheets={})):new x}function S(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),o=0;o!=t.length;++o)n[o]=255&t.charCodeAt(o);return e}function C(t,e){e&&(t+=1462);var n=Date.parse(t);return(n-new Date(Date.UTC(1899,11,30)))/864e5}function A(t){for(var e={},n={s:{c:1e7,r:1e7},e:{c:0,r:0}},o=0;o!=t.length;++o)for(var i=0;i!=t[o].length;++i){n.s.r>o&&(n.s.r=o),n.s.c>i&&(n.s.c=i),n.e.r<o&&(n.e.r=o),n.e.c<i&&(n.e.c=i);var a={v:t[o][i]};if(null!==a.v){var r=XLSX.utils.encode_cell({c:i,r:o});"number"==typeof a.v?a.t="n":"boolean"==typeof a.v?a.t="b":a.v instanceof Date?(a.t="n",a.z=XLSX.SSF._table[14],a.v=C(a.v)):a.t="s",e[r]=a}}return n.s.c<1e7&&(e["!ref"]=XLSX.utils.encode_range(n)),e}function N(t){var e,n,o,i=0;if(0===t.length)return i;for(e=0,o=t.length;o>e;e++)n=t.charCodeAt(e),i=(i<<5)-i+n,i|=0;return i}function E(t,e,n){var o=window.navigator.userAgent;if(t!==!1&&(o.indexOf("MSIE ")>0||o.match(/Trident.*rv\:11\./)))if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(new Blob([n]),t);else{var i=document.createElement("iframe");i&&(document.body.appendChild(i),i.setAttribute("style","display:none"),i.contentDocument.open("txt/html","replace"),i.contentDocument.write(n),i.contentDocument.close(),i.focus(),i.contentDocument.execCommand("SaveAs",!0,t),document.body.removeChild(i))}else{var a=document.createElement("a");a&&(a.style.display="none",t!==!1?a.download=t:a.target="_blank",e.toLowerCase().indexOf("base64,")>=0?a.href=e+j(n):a.href=e+encodeURIComponent(n),document.body.appendChild(a),document.createEvent?(null===T&&(T=document.createEvent("MouseEvents")),T.initEvent("click",!0,!1),a.dispatchEvent(T)):document.createEventObject?a.fireEvent("onclick"):"function"==typeof a.onclick&&a.onclick(),document.body.removeChild(a))}}function k(t){t=t.replace(/\x0d\x0a/g,"\n");for(var e="",n=0;n<t.length;n++){var o=t.charCodeAt(n);128>o?e+=String.fromCharCode(o):o>127&&2048>o?(e+=String.fromCharCode(o>>6|192),e+=String.fromCharCode(63&o|128)):(e+=String.fromCharCode(o>>12|224),e+=String.fromCharCode(o>>6&63|128),e+=String.fromCharCode(63&o|128))}return e}function j(t){var e,n,o,i,a,r,l,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f="",d=0;for(t=k(t);d<t.length;)e=t.charCodeAt(d++),n=t.charCodeAt(d++),o=t.charCodeAt(d++),i=e>>2,a=(3&e)<<4|n>>4,r=(15&n)<<2|o>>6,l=63&o,isNaN(n)?r=l=64:isNaN(o)&&(l=64),f=f+s.charAt(i)+s.charAt(a)+s.charAt(r)+s.charAt(l);return f}var M,D={consoleLog:!1,csvEnclosure:'"',csvSeparator:",",csvUseBOM:!0,displayTableName:!1,escape:!1,excelstyles:[],fileName:"tableExport",htmlContent:!1,ignoreColumn:[],ignoreRow:[],jsonScope:"all",jspdf:{orientation:"p",unit:"pt",format:"a4",margins:{left:20,right:10,top:10,bottom:10},autotable:{styles:{cellPadding:2,rowHeight:12,fontSize:8,fillColor:255,textColor:50,fontStyle:"normal",overflow:"ellipsize",halign:"left",valign:"middle"},headerStyles:{fillColor:[52,73,94],textColor:255,fontStyle:"bold",halign:"center"},alternateRowStyles:{fillColor:245},tableExport:{onAfterAutotable:null,onBeforeAutotable:null,onTable:null,outputImages:!0}}},numbers:{html:{decimalMark:".",thousandsSeparator:","},output:{decimalMark:".",thousandsSeparator:","}},onCellData:null,onCellHtmlData:null,outputMode:"file",pdfmake:{enabled:!1},tbodySelector:"tr",tfootSelector:"tr",theadSelector:"tr",tableName:"myTableName",type:"csv",worksheetName:"xlsWorksheetName"},O=1.15,L=this,T=null,B=[],P=[],R=0,I=[],U="",H=[];if(t.extend(!0,D,e),H=n(L),"csv"==D.type||"txt"==D.type){var W="",F=0;R=0;var K=function(e,n,o){return e.each(function(){U="",i(this,n,R,o+e.length,function(t,e,n){U+=c(t,e,n)+D.csvSeparator}),U=t.trim(U).substring(0,U.length-1),U.length>0&&(W.length>0&&(W+="\n"),W+=U),R++}),e.length};if(F+=K(t(L).find("thead").first().find(D.theadSelector),"th,td",F),t(L).find("tbody").each(function(){F+=K(t(this).find(D.tbodySelector),"td,th",F)}),D.tfootSelector.length&&K(t(L).find("tfoot").first().find(D.tfootSelector),"td,th",F),W+="\n",D.consoleLog===!0&&console.log(W),"string"===D.outputMode)return W;if("base64"===D.outputMode)return j(W);if("window"===D.outputMode)return void E(!1,"data:text/"+("csv"==D.type?"csv":"plain")+";charset=utf-8,",W);try{M=new Blob([W],{type:"text/"+("csv"==D.type?"csv":"plain")+";charset=utf-8"}),saveAs(M,D.fileName+"."+D.type,"csv"!=D.type||D.csvUseBOM===!1)}catch(X){E(D.fileName+"."+D.type,"data:text/"+("csv"==D.type?"csv":"plain")+";charset=utf-8,"+("csv"==D.type&&D.csvUseBOM?"\ufeff":""),W)}}else if("sql"==D.type){R=0;var z="INSERT INTO `"+D.tableName+"` (";if(B=t(L).find("thead").first().find(D.theadSelector),B.each(function(){i(this,"th,td",R,B.length,function(t,e,n){z+="'"+p(t,e,n)+"',"}),R++,z=t.trim(z),z=t.trim(z).substring(0,z.length-1)}),z+=") VALUES ",t(L).find("tbody").each(function(){P.push.apply(P,t(this).find(D.tbodySelector))}),D.tfootSelector.length&&P.push.apply(P,t(L).find("tfoot").find(D.tfootSelector)),t(P).each(function(){U="",i(this,"td,th",R,B.length+P.length,function(t,e,n){U+="'"+p(t,e,n)+"',"}),U.length>3&&(z+="("+U,z=t.trim(z).substring(0,z.length-1),z+="),"),R++}),z=t.trim(z).substring(0,z.length-1),z+=";",D.consoleLog===!0&&console.log(z),"string"===D.outputMode)return z;if("base64"===D.outputMode)return j(z);try{M=new Blob([z],{type:"text/plain;charset=utf-8"}),saveAs(M,D.fileName+".sql")}catch(X){E(D.fileName+".sql","data:application/sql;charset=utf-8,",z)}}else if("json"==D.type){var q=[];B=t(L).find("thead").first().find(D.theadSelector),B.each(function(){var t=[];i(this,"th,td",R,B.length,function(e,n,o){t.push(p(e,n,o))}),q.push(t)});var J=[];t(L).find("tbody").each(function(){P.push.apply(P,t(this).find(D.tbodySelector))}),D.tfootSelector.length&&P.push.apply(P,t(L).find("tfoot").find(D.tfootSelector)),t(P).each(function(){var e={},n=0;i(this,"td,th",R,B.length+P.length,function(t,o,i){q.length?e[q[q.length-1][n]]=p(t,o,i):e[n]=p(t,o,i),n++}),t.isEmptyObject(e)===!1&&J.push(e),R++});var V="";if(V="head"==D.jsonScope?JSON.stringify(q):"data"==D.jsonScope?JSON.stringify(J):JSON.stringify({header:q,data:J}),D.consoleLog===!0&&console.log(V),"string"===D.outputMode)return V;if("base64"===D.outputMode)return j(V);try{M=new Blob([V],{type:"application/json;charset=utf-8"}),saveAs(M,D.fileName+".json")}catch(X){E(D.fileName+".json","data:application/json;charset=utf-8;base64,",V)}}else if("xml"===D.type){R=0;var $='<?xml version="1.0" encoding="utf-8"?>';$+="<tabledata><fields>",B=t(L).find("thead").first().find(D.theadSelector),B.each(function(){i(this,"th,td",R,B.length,function(t,e,n){$+="<field>"+p(t,e,n)+"</field>"}),R++}),$+="</fields><data>";var _=1;if(t(L).find("tbody").each(function(){P.push.apply(P,t(this).find(D.tbodySelector))}),D.tfootSelector.length&&P.push.apply(P,t(L).find("tfoot").find(D.tfootSelector)),t(P).each(function(){var t=1;U="",i(this,"td,th",R,B.length+P.length,function(e,n,o){U+="<column-"+t+">"+p(e,n,o)+"</column-"+t+">",t++}),U.length>0&&"<column-1></column-1>"!=U&&($+='<row id="'+_+'">'+U+"</row>",_++),R++}),$+="</data></tabledata>",D.consoleLog===!0&&console.log($),"string"===D.outputMode)return $;if("base64"===D.outputMode)return j($);try{M=new Blob([$],{type:"application/xml;charset=utf-8"}),saveAs(M,D.fileName+".xml")}catch(X){E(D.fileName+".xml","data:application/xml;charset=utf-8;base64,",$)}}else if("excel"==D.type||"xls"==D.type||"word"==D.type||"doc"==D.type){var Q="excel"==D.type||"xls"==D.type?"excel":"word",Y="excel"==Q?"xls":"doc",G='xmlns:x="urn:schemas-microsoft-com:office:'+Q+'"',Z=t(L).filter(function(){return"none"!=t(this).data("tableexportDisplay")&&(t(this).is(":visible")||"always"==t(this).data("tableexportDisplay"))}),tt="";Z.each(function(){var e=t(this);R=0,H=n(this),tt+="<table><thead>",B=e.find("thead").first().find(D.theadSelector),B.each(function(){U="",i(this,"th,td",R,B.length,function(e,n,o){if(null!==e){var i="";U+="<th";for(var a in D.excelstyles)if(D.excelstyles.hasOwnProperty(a)){var r=t(e).css(D.excelstyles[a]);""!==r&&"0px none rgb(0, 0, 0)"!=r&&"rgba(0, 0, 0, 0)"!=r&&(i+=""===i?'style="':";",i+=D.excelstyles[a]+":"+r)}""!==i&&(U+=" "+i+'"'),t(e).is("[colspan]")&&(U+=' colspan="'+t(e).attr("colspan")+'"'),t(e).is("[rowspan]")&&(U+=' rowspan="'+t(e).attr("rowspan")+'"'),U+=">"+p(e,n,o)+"</th>"}}),U.length>0&&(tt+="<tr>"+U+"</tr>"),R++}),tt+="</thead><tbody>",e.find("tbody").each(function(){P.push.apply(P,t(this).find(D.tbodySelector))}),D.tfootSelector.length&&P.push.apply(P,e.find("tfoot").find(D.tfootSelector)),t(P).each(function(){var e=t(this);U="",i(this,"td,th",R,B.length+P.length,function(n,o,i){if(null!==n){var a="",r=t(n).data("tableexportMsonumberformat");"undefined"==typeof r&&"function"==typeof D.onMsoNumberFormat&&(r=D.onMsoNumberFormat(n,o,i)),"undefined"!=typeof r&&""!==r&&(a="style=\"mso-number-format:'"+r+"'");for(var l in D.excelstyles)D.excelstyles.hasOwnProperty(l)&&(r=t(n).css(D.excelstyles[l]),""===r&&(r=e.css(D.excelstyles[l])),""!==r&&"0px none rgb(0, 0, 0)"!=r&&"rgba(0, 0, 0, 0)"!=r&&(a+=""===a?'style="':";",a+=D.excelstyles[l]+":"+r));U+="<td",""!==a&&(U+=" "+a+'"'),t(n).is("[colspan]")&&(U+=' colspan="'+t(n).attr("colspan")+'"'),t(n).is("[rowspan]")&&(U+=' rowspan="'+t(n).attr("rowspan")+'"'),U+=">"+p(n,o,i).replace(/\n/g,"<br>")+"</td>"}}),U.length>0&&(tt+="<tr>"+U+"</tr>"),R++}),D.displayTableName&&(tt+="<tr><td></td></tr><tr><td></td></tr><tr><td>"+p(t("<p>"+D.tableName+"</p>"))+"</td></tr>"),tt+="</tbody></table>",D.consoleLog===!0&&console.log(tt)});var et='<html xmlns:o="urn:schemas-microsoft-com:office:office" '+G+' xmlns="http://www.w3.org/TR/REC-html40">';if(et+='<meta http-equiv="content-type" content="application/vnd.ms-'+Q+'; charset=UTF-8">',et+="<head>","excel"===Q&&(et+="<!--[if gte mso 9]>",et+="<xml>",et+="<x:ExcelWorkbook>",et+="<x:ExcelWorksheets>",et+="<x:ExcelWorksheet>",et+="<x:Name>",et+=D.worksheetName,et+="</x:Name>",et+="<x:WorksheetOptions>",et+="<x:DisplayGridlines/>",et+="</x:WorksheetOptions>",et+="</x:ExcelWorksheet>",et+="</x:ExcelWorksheets>",et+="</x:ExcelWorkbook>",et+="</xml>",et+="<![endif]-->"),et+="<style>br {mso-data-placement:same-cell;}</style>",et+="</head>",et+="<body>",et+=tt,et+="</body>",et+="</html>",D.consoleLog===!0&&console.log(et),"string"===D.outputMode)return et;if("base64"===D.outputMode)return j(et);try{M=new Blob([et],{type:"application/vnd.ms-"+D.type}),saveAs(M,D.fileName+"."+Y)}catch(X){E(D.fileName+"."+Y,"data:application/vnd.ms-"+Q+";base64,",et)}}else if("xlsx"==D.type){var nt=[],ot=[];R=0,P=t(L).find("thead").first().find(D.theadSelector),t(L).find("tbody").each(function(){P.push.apply(P,t(this).find(D.tbodySelector))}),D.tfootSelector.length&&P.push.apply(P,t(L).find("tfoot").find(D.tfootSelector)),t(P).each(function(){var t=[];i(this,"th,td",R,P.length,function(e,n,o){if("undefined"!=typeof e&&null!==e){var i=parseInt(e.getAttribute("colspan")),a=parseInt(e.getAttribute("rowspan")),r=p(e,n,o);if(""!==r&&r==+r&&(r=+r),ot.forEach(function(e){if(R>=e.s.r&&R<=e.e.r&&t.length>=e.s.c&&t.length<=e.e.c)for(var n=0;n<=e.e.c-e.s.c;++n)t.push(null)}),(a||i)&&(a=a||1,i=i||1,ot.push({s:{r:R,c:t.length},e:{r:R+a-1,c:t.length+i-1}})),t.push(""!==r?r:null),i)for(var l=0;i-1>l;++l)t.push(null)}}),nt.push(t),R++});var it=new x,at=A(nt);at["!merges"]=ot,it.SheetNames.push(D.worksheetName),it.Sheets[D.worksheetName]=at;var rt=XLSX.write(it,{bookType:D.type,bookSST:!1,type:"binary"});try{M=new Blob([S(rt)],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet; charset=UTF-8"}),saveAs(M,D.fileName+"."+D.type)}catch(X){E(D.fileName+"."+D.type,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet; charset=UTF-8",nt)}}else if("png"==D.type)html2canvas(t(L)[0]).then(function(t){for(var e=t.toDataURL(),n=atob(e.substring(22)),o=new ArrayBuffer(n.length),i=new Uint8Array(o),a=0;a<n.length;a++)i[a]=n.charCodeAt(a);if(D.consoleLog===!0&&console.log(n),"string"===D.outputMode)return n;if("base64"===D.outputMode)return j(e);if("window"===D.outputMode)return void window.open(e);try{M=new Blob([o],{type:"image/png"}),saveAs(M,D.fileName+".png")}catch(r){E(D.fileName+".png","data:image/png,",e)}});else if("pdf"==D.type)if(D.pdfmake.enabled===!0){var lt=[],st=[];R=0,B=t(this).find("thead").first().find(D.theadSelector),B.each(function(){var t=[];i(this,"th,td",R,B.length,function(e,n,o){t.push(p(e,n,o))}),t.length&&st.push(t);for(var e=lt.length;e<t.length;e++)lt.push("*");R++}),t(this).find("tbody").each(function(){P.push.apply(P,t(this).find(D.tbodySelector))}),D.tfootSelector.length&&P.push.apply(P,t(this).find("tfoot").find(D.tfootSelector)),t(P).each(function(){var t=[];i(this,"td,th",R,B.length+P.length,function(e,n,o){t.push(p(e,n,o))}),t.length&&st.push(t),R++});var ft={pageOrientation:"landscape",content:[{table:{headerRows:B.length,widths:lt,body:st}}]};pdfMake.createPdf(ft).getBuffer(function(t){try{var e=new Blob([t],{type:"application/pdf"});saveAs(e,D.fileName+".pdf")}catch(n){E(D.fileName+".pdf","data:application/pdf;base64,",t)}})}else if(D.jspdf.autotable===!1){var dt={dim:{w:w(t(L).first().get(0),"width","mm"),h:w(t(L).first().get(0),"height","mm")},pagesplit:!1},ht=new jsPDF(D.jspdf.orientation,D.jspdf.unit,D.jspdf.format);ht.addHTML(t(L).first(),D.jspdf.margins.left,D.jspdf.margins.top,dt,function(){a(ht)})}else{var ct=D.jspdf.autotable.tableExport;if("string"==typeof D.jspdf.format&&"bestfit"===D.jspdf.format.toLowerCase()){var ut={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89]},pt="",yt="",gt=0;t(L).filter(":visible").each(function(){if("none"!=t(this).css("display")){var e=w(t(this).get(0),"width","pt");if(e>gt){e>ut.a0[0]&&(pt="a0",yt="l");for(var n in ut)ut.hasOwnProperty(n)&&ut[n][1]>e&&(pt=n,yt="l",ut[n][0]>e&&(yt="p"));gt=e}}}),D.jspdf.format=""===pt?"a4":pt,D.jspdf.orientation=""===yt?"w":yt}ct.doc=new jsPDF(D.jspdf.orientation,D.jspdf.unit,D.jspdf.format),ct.outputImages===!0&&(ct.images={}),"undefined"!=typeof ct.images&&(t(L).filter(function(){return"none"!=t(this).data("tableexportDisplay")&&(t(this).is(":visible")||"always"==t(this).data("tableexportDisplay"))}).each(function(){var e=0;B=t(this).find("thead").find(D.theadSelector),t(this).find("tbody").each(function(){P.push.apply(P,t(this).find(D.tbodySelector))}),D.tfootSelector.length&&P.push.apply(P,t(this).find("tfoot").find(D.tfootSelector)),t(P).each(function(){i(this,"td,th",B.length+e,B.length+P.length,function(e,n,o){if("undefined"!=typeof e&&null!==e){var i=t(e).children();"undefined"!=typeof i&&i.length>0&&l(e,i,ct)}}),e++})}),B=[],P=[]),s(ct,function(e){t(L).filter(function(){return"none"!=t(this).data("tableexportDisplay")&&(t(this).is(":visible")||"always"==t(this).data("tableexportDisplay"))}).each(function(){var e,o=0;if(H=n(this),ct.columns=[],ct.rows=[],ct.rowoptions={},"function"==typeof ct.onTable&&ct.onTable(t(this),D)===!1)return!0;D.jspdf.autotable.tableExport=null;var a=t.extend(!0,{},D.jspdf.autotable);D.jspdf.autotable.tableExport=ct,a.margin={},t.extend(!0,a.margin,D.jspdf.margins),a.tableExport=ct,"function"!=typeof a.beforePageContent&&(a.beforePageContent=function(t){if(1==t.pageCount){var e=t.table.rows.concat(t.table.headerRow);e.forEach(function(e){e.height>0&&(e.height+=(2-O)/2*e.styles.fontSize,t.table.height+=(2-O)/2*e.styles.fontSize)})}}),"function"!=typeof a.createdHeaderCell&&(a.createdHeaderCell=function(e,n){if(e.styles=t.extend({},n.row.styles),"undefined"!=typeof ct.columns[n.column.dataKey]){var o=ct.columns[n.column.dataKey];if("undefined"!=typeof o.rect){var i;e.contentWidth=o.rect.width,("undefined"==typeof ct.heightRatio||0===ct.heightRatio)&&(i=n.row.raw[n.column.dataKey].rowspan?n.row.raw[n.column.dataKey].rect.height/n.row.raw[n.column.dataKey].rowspan:n.row.raw[n.column.dataKey].rect.height,ct.heightRatio=e.styles.rowHeight/i),i=n.row.raw[n.column.dataKey].rect.height*ct.heightRatio,i>e.styles.rowHeight&&(e.styles.rowHeight=i)}"undefined"!=typeof o.style&&o.style.hidden!==!0&&(e.styles.halign=o.style.align,"inherit"===a.styles.fillColor&&(e.styles.fillColor=o.style.bcolor),"inherit"===a.styles.textColor&&(e.styles.textColor=o.style.color),"inherit"===a.styles.fontStyle&&(e.styles.fontStyle=o.style.fstyle))}}),"function"!=typeof a.createdCell&&(a.createdCell=function(t,e){var n=ct.rowoptions[e.row.index+":"+e.column.dataKey];"undefined"!=typeof n&&"undefined"!=typeof n.style&&n.style.hidden!==!0&&(t.styles.halign=n.style.align,"inherit"===a.styles.fillColor&&(t.styles.fillColor=n.style.bcolor),"inherit"===a.styles.textColor&&(t.styles.textColor=n.style.color),"inherit"===a.styles.fontStyle&&(t.styles.fontStyle=n.style.fstyle))}),"function"!=typeof a.drawHeaderCell&&(a.drawHeaderCell=function(t,e){var n=ct.columns[e.column.dataKey];return(n.style.hasOwnProperty("hidden")!==!0||n.style.hidden!==!0)&&n.rowIndex>=0?r(t,e,n):!1}),"function"!=typeof a.drawCell&&(a.drawCell=function(t,e){var n=ct.rowoptions[e.row.index+":"+e.column.dataKey];if(r(t,e,n)){if(ct.doc.rect(t.x,t.y,t.width,t.height,t.styles.fillStyle),"undefined"!=typeof n&&"undefined"!=typeof n.kids&&n.kids.length>0){var o=t.height/n.rect.height;(o>ct.dh||"undefined"==typeof ct.dh)&&(ct.dh=o),ct.dw=t.width/n.rect.width,f(t,n.kids,ct)}ct.doc.autoTableText(t.text,t.textPos.x,t.textPos.y,{halign:t.styles.halign,valign:t.styles.valign})}return!1}),ct.headerrows=[],B=t(this).find("thead").find(D.theadSelector),B.each(function(){e=0,ct.headerrows[o]=[],i(this,"th,td",o,B.length,function(t,n,i){var a=m(t);a.title=p(t,n,i),a.key=e++,a.rowIndex=o,ct.headerrows[o].push(a)}),o++}),o>0&&t.each(ct.headerrows[o-1],function(){var t=this;o>1&&null===this.rect&&(t=ct.headerrows[o-2][this.key]),null!==t&&ct.columns.push(t)});var l=0;P=[],t(this).find("tbody").each(function(){P.push.apply(P,t(this).find(D.tbodySelector))}),D.tfootSelector.length&&P.push.apply(P,t(this).find("tfoot").find(D.tfootSelector)),t(P).each(function(){var n=[];e=0,i(this,"td,th",o,B.length+P.length,function(o,i,a){if("undefined"==typeof ct.columns[e]){var r={title:"",key:e,style:{hidden:!0}};ct.columns.push(r)}if("undefined"!=typeof o&&null!==o){var r=m(o);r.kids=t(o).children(),ct.rowoptions[l+":"+e++]=r}else{var r=t.extend(!0,{},ct.rowoptions[l+":"+(e-1)]);r.colspan=-1,ct.rowoptions[l+":"+e++]=r}n.push(p(o,i,a))}),n.length&&(ct.rows.push(n),l++),o++}),"function"==typeof ct.onBeforeAutotable&&ct.onBeforeAutotable(t(this),ct.columns,ct.rows,a),ct.doc.autoTable(ct.columns,ct.rows,a),"function"==typeof ct.onAfterAutotable&&ct.onAfterAutotable(t(this),a),D.jspdf.autotable.startY=ct.doc.autoTableEndPosY()+a.margin.top}),a(ct.doc),"undefined"!=typeof ct.headerrows&&(ct.headerrows.length=0),"undefined"!=typeof ct.columns&&(ct.columns.length=0),"undefined"!=typeof ct.rows&&(ct.rows.length=0),delete ct.doc,ct.doc=null})}return this}})}(jQuery);